import XCTest
@testable import OmiseSDK
import OmiseTestSDK
import Foundation

class SHA512Tests: XCTestCase {

    func testSHA512EmptyString() {
        let emptyString = ""
        let expectedHash = Data(
            // swiftlint:disable:next multiline_literal_brackets
            [ // expected SHA-512 hash of empty string
                0xcf, 0x83, 0xe1, 0x35, 0x7e, 0xef, 0xb8, 0xbd,
                0xf1, 0x54, 0x28, 0x50, 0xd6, 0x6d, 0x80, 0x07,
                0xd6, 0x20, 0xe4, 0x05, 0x0b, 0x57, 0x15, 0xdc,
                0x83, 0xf4, 0xa9, 0x21, 0xd3, 0x6c, 0xe9, 0xce,
                0x47, 0xd0, 0xd1, 0x3c, 0x5d, 0x85, 0xf2, 0xb0,
                0xff, 0x83, 0x18, 0xd2, 0x87, 0x7e, 0xec, 0x2f,
                0x63, 0xb9, 0x31, 0xbd, 0x47, 0x41, 0x7a, 0x81,
                0xa5, 0x38, 0x32, 0x7a, 0xf9, 0x27, 0xda, 0x3e
            ]
        )
        XCTAssertEqual(emptyString.sha512, expectedHash)
    }

    func testSHA512NonEmptyString() {
        let testString = "Hello, World!"
        let expectedHash = Data(
            // swiftlint:disable:next multiline_literal_brackets
            [ // expected SHA-512 hash of "Hello, World!"
                0x86, 0x40, 0x7d, 0x44, 0x5e, 0xda, 0x4b, 0xa5,
                0xab, 0x25, 0xc7, 0x88, 0x4e, 0xc2, 0x64, 0xcc,
                0x99, 0x00, 0xe4, 0x30, 0x9b, 0x6b, 0xa0, 0x8f,
                0x43, 0x6d, 0x82, 0x5e, 0x2f, 0x28, 0xa4, 0xb6,
                0xf7, 0xd9, 0xd5, 0x1f, 0x2d, 0x6e, 0x61, 0x88,
                0x14, 0x7f, 0xc5, 0x99, 0x21, 0x6a, 0x49, 0x3b,
                0xfa, 0x0d, 0x2e, 0x33, 0x4a, 0x18, 0x2e, 0x2b,
                0xb4, 0xb5, 0x9c, 0x29, 0x54, 0xa6, 0x6a, 0xae
            ]
        )
        XCTAssertEqual(testString.sha512, expectedHash)
    }
}
